*
* Low-Pass Filter + Limiter
*

* forces current values to be saved
.options savecurrents

******************************************

.param pi = 3.14159265359
.param n = '24'
*.param n = '(sqrt(2)*230/12)'

* input voltage source
*vS 1 0 0 sin(0 'sqrt(2)*230' '2*pi*50')
vS 2 3 0 sin(0 'sqrt(2)*230/n' 50)
*vS 1 0 0 sin(0 5 400)

* Full-Wave bridge rectifier 
Dd1 0 2 Default
Dd2 2 4 Default
Dd3 0 3 Default
Dd4 3 4 Default
*Ca 2 0 1u
Ci 4 0 20u
*Cb 3 0 1u
Ra 4 0 20k
Ri 4 9 1k

* positive limiter
Dp1 9 5 Default
Dp2 5 6 Default
Dp3 6 0 Default

* negative limiter
*Dn1 0 7 Default
*Dn2 7 8 Default
*Dn3 8 9 Default


.measure tran y4avg AVG v(4) from=20m to=220m
.measure tran y4max MAX v(4) from=20m to=220m
.measure tran y4min MIN v(4) from=20m to=220m
.measure tran ripp param='y4max - y4min'


.model Default D
.op

.end

.control

*makes plots in color
set hcopypscolor=0
set color0=white
set color1=black
set color2=red
set color3=blue
set color4=violet
set color5=rgb:3/8/0
set color6=rgb:4/0/0

******************************************
* analise no tempo
tran 1e-4 220e-3


plot  v(2,3) v(4)
plot 'v(4)-12'

hardcopy vospice50.ps v(2,3) v(4)
hardcopy voripple.ps 'v(4)-12'
* hardcopy vospice400.ps v(1) v(2)

*quit
.endc

.end