\section{Simulation Analysis}
\label{sec:simulation}
To simulate the Audio Amplifier Circuit we used two sub-circuits, the gain stage circuit, and the output stage circuit.
To amplify the voltage measured at the input it is necessary to use a gain stage circuit that adds a gain to the input voltage and it is also necessary to decrease the output impedance because the speaker has an impedance of 8 $\Omega$ and the output impedance should be much smaller than the impedance of the speaker. To do that we use an output stage circuit that maintains the gain (approximately) and decreases the output impedance, as we have stated before.

The output voltage gain measured by the theoretical analysis \ref{Fig2: TheoGaindB} and the one simulated in ngspice,  represented below have a visible difference between them. The theoretical analysis does not have a higher cutoff frequency which is present in the simulated data. This is due to the fact that the theoretical circuit does not consider the presence of two capacitors in the transistor model, which are considered in the ngspice simulation and simulate the higher cutoff frequency. It is also visible that the gain of the theoretical analysis is lower than the one obtained by ngspice, this is due to the fact that the model of the transistor used by ngspice considers much more parameters than the model that was used in the theoretical simulation. This causes the current in the collector to be greater in the simulation than in the theoretical analysis which causes the transconductance to be smaller and this parameter is related to the gain.
If it had been considered that Ro in the equivalent circuit then the calculated gain would be bigger than the theoretical gain.

In order to obtain the circuit's output impedance, we had to create a new script which allowed us to compute this value. For this we removed the input from the circuit and created a new voltage source in the output terminal, computing the impedance with the values of our auxiliar voltage source and the current flowing through it.
The data obtained through Ngspice is as follows:

\begin{figure}[h] 
\centering
\includegraphics[width=0.6\linewidth]{vdbcoll.eps}
\caption{Gain Stage Gain in dB.}
\label{Fig3: GainStgGaindB}
\end{figure}

\begin{figure}[h] 
\centering
\includegraphics[width=0.6\linewidth]{vdbout.eps}
\caption{Circuit Total Gain in dB.}
\label{Fig4: SimGaindB}
\end{figure}

\begin{table}[H]
\centering
\begin{tabular}{|l|l|}
\hline
{\bf Name} & {\bf Value} \\ \hline
    \input{SIM_RESULTS_TAB}
\end{tabular}
\caption{\textbf{Circuit's Cut-Off Frequencies, Bandwidth (in Hz) and Output Amplitude (either in V and dB)}}
\end{table}

\begin{table}[H]
\centering
\begin{tabular}{|l|l|}
\hline
{\bf Name} & {\bf Value} \\ \hline
    \input{ZI_TAB}
    \input{ZO_TAB}
\end{tabular}
\caption{\textbf{Input and Output Impedance (in Ohm) }}
\end{table}

The following table proves that the circuit is working in forward active region.

\begin{table}[H]
\centering
\begin{tabular}{|l|l|}
\hline
{\bf Name} & {\bf Value} \\ \hline
    \input{FAR_TAB}
\end{tabular}
\caption{\textbf{Forward Active Region Verification}}
\end{table}
