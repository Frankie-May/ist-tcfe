\section{Theoretical Analysis}
\label{sec:analysis}

To theoretically analyse the circuit, as stated before, we make use of two circuit analysing methods, the Meshes' Method and the Nodes' Method.

The Meshes' Method consists in writing Kirchhoff's Voltage Law (KVL) for every mesh in the circuit. To do so we assume that every mesh has a current associated with it, which flows only in this mesh. We call this currents mesh currents. It is with this mesh currents that we may write the KVL. Per example, for resistor $R1$ we write its voltage as $V_{R1} =R_1*I_{M1}$ where $I_{M1}$ is the mesh current that flows through the upper-left mesh. For circuit components in the border between two meshes the current flowing through them is the sum of the adjacent mesh currents. Per example,assuming that all mesh currents flow clockwise, for resistor $R3$, the current flowing through it is given by $I_{R3} = I_{M1}-I_{M2}$. We then write voltage between the resistor's terminals using Ohm's Law the same way we did with resistor $R1$.

When analysing a circuit with the Nodes' Method we associate different voltages to every node, as we associated different currents to every mesh. By writing Kirchhoff's Current Law (KCL) for every node that is not connected to a voltage source we obtain the equations which will determine the voltage values in each node. Because most of the times this equations are not enough to all nodes' voltage, we may obtain other equations through direct circuit analysis. Per example, defining the node that connects $V_a$, $R_4$ and $R_6$ as the $0V$ node, we have that the voltage in the upper-right node, which we may call node A is equal to the voltage created by voltage source $V_a$. That is, $V_A = V_a$. KCL must be written in terms of the nodes' voltages. To do so we only need to apply Ohm's Law to obtain the current flowing through the resistors in terms of its terminal's voltage.

\begin{equation}
\begin{bmatrix}
\centering
G1+G2+G3 & -G2 & -G3 & 0 & 0 & 0 & 0\\ %Nó B
-G2-Kb & G2 & Kb & 0 & 0 & 0 & 0\\ %Nó C
-G3 & 0 & G3+G4+G5 & -G5 & 0 & 0 & -1\\ %Nó D
Kb & 0 & -G5-Kb & G5 & 0 & 0 & 0\\ %Nó E
0 & 0 & 0 & 0 & G6+G7 & -G7 & 0\\ %Nó F
0 & 0 & 0 & 0 & -G7 & G7 & 1\\ %Nó G
0 & 0 & 1 & 0 & Kc*G6 & -1 & 0 %Tensão D com tensão G
\end{bmatrix}
\end{equation}

The above matrix is used in the Nodes' Method. The first five equations are obtained directly through KCL applied to nodes B, C, D, E and F respectively. The sixth equation is obtained through KCL applied to node G. The last equation relates node D's voltage with node G's through the dependent voltage source $V_C$ ($V_C=K_C*I_C$).

\begin{equation}
\begin{bmatrix}
\centering
R1+R3+R4 & -R3 & -R4 & 0\\
Kb*R3 & 1-Kb*R3 & 0 & 0\\
-R4 & 0 & R4+R6+R7-Kc & 0\\
 0 & 0 & 0 & 1
\end{bmatrix}
\end{equation}
\par
\par
The above matrix is used in the Meshes' Method. These equations were obtained directly through KVL applied to meshes j, k, l and m respectively.


\begin{table}[h]
  \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Value [A or V]} \\ \hline
    \input{MA_tab}
  \end{tabular}
  \caption{Voltages and currents obtained through Meshes' analysis.}
  \label{tab:MA}
\end{table}

\begin{table}[h]
  \centering
  \begin{tabular}{|l|r|}
    \hline
    {\bf Name} & {\bf Value [A or V]} \\ \hline
    \input{NA_tab}
  \end{tabular}
  \caption{Voltages and Currents obtained through Nodes' Analysis}
  \label{tab:NA}
\end{table}

